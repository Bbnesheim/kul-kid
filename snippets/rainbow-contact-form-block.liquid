{% assign block_uid = block.id | replace: '_', '' | downcase %}
{% assign ai_gen_id = block_uid %}

{% comment %} Rainbow Contact Form Block (snippet) {% endcomment %}

{% style %}
  .ai-contact-form-wrapper-{{ ai_gen_id }} { padding: {{ block.settings.section_padding_top }}px {{ block.settings.section_padding_horizontal }}px {{ block.settings.section_padding_bottom }}px; }
  .ai-contact-form-{{ ai_gen_id }} { position: relative; max-width: {{ block.settings.max_width }}px; margin: 0 auto; border-radius: {{ block.settings.section_border_radius }}px; }
  .ai-contact-form-{{ ai_gen_id }}::before { content:''; position:absolute; top:-{{ block.settings.border_thickness }}px; left:-{{ block.settings.border_thickness }}px; right:-{{ block.settings.border_thickness }}px; bottom:-{{ block.settings.border_thickness }}px; background:
    {% if block.settings.animation_direction == 'diagonal' %}linear-gradient(45deg,{% elsif block.settings.animation_direction == 'horizontal' %}linear-gradient(90deg,{% elsif block.settings.animation_direction == 'vertical' %}linear-gradient(180deg,{% else %}radial-gradient(circle,{% endif %}
    {{ block.settings.rainbow_color_1 }}, {{ block.settings.rainbow_color_2 }}, {{ block.settings.rainbow_color_3 }}, {{ block.settings.rainbow_color_4 }}, {{ block.settings.rainbow_color_5 }}, {{ block.settings.rainbow_color_6 }}, {{ block.settings.rainbow_color_1 }});
    background-size: {{ block.settings.gradient_size }}% {{ block.settings.gradient_size }}%; border-radius: {{ block.settings.section_border_radius | plus: block.settings.border_thickness }}px;
    {% if block.settings.enable_animation %}animation: ai-rainbow-flow-{{ ai_gen_id }} {{ block.settings.animation_speed }}s {{ block.settings.animation_timing }} infinite {% if block.settings.animation_reverse %}reverse{% endif %}{% endif %};
    filter: blur({{ block.settings.blur_intensity }}px) brightness({{ block.settings.brightness }}%) saturate({{ block.settings.saturation }}%);
    z-index:-1; opacity: {{ block.settings.border_opacity | divided_by: 100.0 }}; }
  {% if block.settings.enable_hover_effect %}
    .ai-contact-form-{{ ai_gen_id }}:hover::before { animation-duration: {{ block.settings.hover_speed }}s; filter: blur({{ block.settings.hover_blur }}px) brightness({{ block.settings.hover_brightness }}%) saturate({{ block.settings.hover_saturation }}%); opacity: {{ block.settings.hover_opacity | divided_by: 100.0 }}; }
  {% endif %}
  @keyframes ai-rainbow-flow-{{ ai_gen_id }} {
    {% if block.settings.animation_pattern == 'smooth' %}0%,100%{background-position:0% 50%}25%{background-position:100% 50%}50%{background-position:100% 100%}75%{background-position:0% 100%}
    {% elsif block.settings.animation_pattern == 'wave' %}0%{background-position:0% 0%}25%{background-position:100% 0%}50%{background-position:100% 100%}75%{background-position:0% 100%}100%{background-position:0% 0%}
    {% elsif block.settings.animation_pattern == 'pulse' %}0%,100%{background-position:50% 50%; background-size: {{ block.settings.gradient_size }}% {{ block.settings.gradient_size }}%;}50%{background-position:50% 50%; background-size: {{ block.settings.gradient_size | times: 1.5 }}% {{ block.settings.gradient_size | times: 1.5 }}%;}
    {% else %}0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}{% endif %}
  }
  .ai-contact-form__content-{{ ai_gen_id }} { position:relative; background: {{ block.settings.background_color }}; border-radius: {{ block.settings.section_border_radius }}px; padding: {{ block.settings.content_padding }}px; z-index:1; }
  .ai-contact-form__header-{{ ai_gen_id }} { text-align: {{ block.settings.text_alignment }}; margin-bottom: 32px; }
  .ai-contact-form__title-{{ ai_gen_id }} { font-family: {{ block.settings.title_font.family }}, {{ block.settings.title_font.fallback_families }}; font-weight: {{ block.settings.title_font.weight }}; font-size: {{ block.settings.title_size }}px; color: {{ block.settings.title_color }}; margin:0 0 16px; line-height:1.3; }
  .ai-contact-form__subtitle-{{ ai_gen_id }} { font-family: {{ block.settings.body_font.family }}, {{ block.settings.body_font.fallback_families }}; font-weight: {{ block.settings.body_font.weight }}; font-size: {{ block.settings.subtitle_size }}px; color: {{ block.settings.subtitle_color }}; margin:0; line-height:1.5; }
  .ai-contact-form__subtitle-{{ ai_gen_id }} a { color: {{ block.settings.link_color }}; text-decoration: {{ block.settings.link_underline }}; transition: color .3s; }
  .ai-contact-form__subtitle-{{ ai_gen_id }} a:hover { color: {{ block.settings.link_hover_color }}; }
  .ai-contact-form__subtitle-{{ ai_gen_id }} p { margin:0; }
  .ai-contact-form__form-{{ ai_gen_id }} { display:grid; gap:20px; }
  .ai-contact-form__field-group-{{ ai_gen_id }} { display:grid; gap:20px; grid-template-columns:1fr; }
  .ai-contact-form__field-group-{{ ai_gen_id }}--two-columns { grid-template-columns:1fr 1fr; }
  .ai-contact-form__field-{{ ai_gen_id }} { display:flex; flex-direction:column; gap:8px; }
  .ai-contact-form__label-{{ ai_gen_id }} { font-family: {{ block.settings.body_font.family }}, {{ block.settings.body_font.fallback_families }}; font-weight: {{ block.settings.body_font.weight }}; font-size: {{ block.settings.label_size }}px; color: {{ block.settings.label_color }}; margin:0; }
  .ai-contact-form__input-{{ ai_gen_id }}, .ai-contact-form__select-{{ ai_gen_id }}, .ai-contact-form__textarea-{{ ai_gen_id }} { font-family: {{ block.settings.body_font.family }}, {{ block.settings.body_font.fallback_families }}; font-weight: {{ block.settings.body_font.weight }}; font-size: {{ block.settings.input_size }}px; padding: {{ block.settings.input_padding }}px; border: {{ block.settings.input_border_width }}px solid {{ block.settings.input_border_color }}; border-radius: {{ block.settings.input_border_radius }}px; background: {{ block.settings.input_background }}; color: {{ block.settings.input_text_color }}; transition: border-color .3s, box-shadow .3s; width:100%; box-sizing:border-box; }
  .ai-contact-form__input-{{ ai_gen_id }}:focus, .ai-contact-form__select-{{ ai_gen_id }}:focus, .ai-contact-form__textarea-{{ ai_gen_id }}:focus { outline:none; border-color: {{ block.settings.input_focus_border_color }}; box-shadow:0 0 0 3px {{ block.settings.input_focus_border_color }}33; }
  .ai-contact-form__input-{{ ai_gen_id }}::placeholder, .ai-contact-form__textarea-{{ ai_gen_id }}::placeholder { color: {{ block.settings.placeholder_color }}; opacity:1; }
  .ai-contact-form__textarea-{{ ai_gen_id }} { min-height: {{ block.settings.textarea_height }}px; resize:vertical; }
  .ai-contact-form__select-{{ ai_gen_id }} { cursor:pointer; appearance:none; background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e"); background-position:right 12px center; background-repeat:no-repeat; background-size:16px; padding-right:40px; }
  .ai-contact-form__button-{{ ai_gen_id }} { font-family: {{ block.settings.body_font.family }}, {{ block.settings.body_font.fallback_families }}; font-weight: {{ block.settings.body_font.weight }}; font-size: {{ block.settings.button_size }}px; padding: {{ block.settings.button_padding }}px {{ block.settings.button_padding | times: 1.5 }}px; background: {{ block.settings.button_background }}; color: {{ block.settings.button_text_color }}; border:none; border-radius: {{ block.settings.button_border_radius }}px; cursor:pointer; transition:.3s; width:100%; max-width: {{ block.settings.button_max_width }}px; margin:0 auto; justify-self: {{ block.settings.text_alignment }}; }
  .ai-contact-form__button-{{ ai_gen_id }}:hover { background: {{ block.settings.button_hover_background }}; transform: translateY(-2px); box-shadow: 0 4px 12px {{ block.settings.button_background }}40; }
  .ai-contact-form__message-{{ ai_gen_id }} { font-family: {{ block.settings.body_font.family }}, {{ block.settings.body_font.fallback_families }}; font-weight: {{ block.settings.body_font.weight }}; font-size: {{ block.settings.input_size }}px; padding:16px; border-radius: {{ block.settings.input_border_radius }}px; margin-top:16px; text-align:center; }
  .ai-contact-form__success-{{ ai_gen_id }} { background: {{ block.settings.success_background }}; color: {{ block.settings.success_text_color }}; border:1px solid {{ block.settings.success_border_color }}; }
  .ai-contact-form__error-{{ ai_gen_id }} { background: {{ block.settings.error_background }}; color: {{ block.settings.error_text_color }}; border:1px solid {{ block.settings.error_border_color }}; }
  @media (max-width:749px){ .ai-contact-form-wrapper-{{ ai_gen_id }}{ padding: {{ block.settings.section_padding_top | times: 0.75 }}px {{ block.settings.section_padding_horizontal | times: 0.75 }}px {{ block.settings.section_padding_bottom | times: 0.75 }}px; } .ai-contact-form__content-{{ ai_gen_id }}{ padding: {{ block.settings.content_padding | times: 0.75 }}px; } .ai-contact-form__field-group-{{ ai_gen_id }}--two-columns{ grid-template-columns:1fr; } .ai-contact-form__title-{{ ai_gen_id }}{ font-size: {{ block.settings.title_size | times: 0.85 }}px; } .ai-contact-form__subtitle-{{ ai_gen_id }}{ font-size: {{ block.settings.subtitle_size | times: 0.9 }}px; } }
{% endstyle %}

<div class="ai-contact-form-wrapper-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-contact-form-{{ ai_gen_id }}">
    <div class="ai-contact-form__content-{{ ai_gen_id }}">
      <div class="ai-contact-form__header-{{ ai_gen_id }}">
        <h2 class="ai-contact-form__title-{{ ai_gen_id }}">{{ block.settings.title }}</h2>
        {% if block.settings.subtitle != blank %}
          <div class="ai-contact-form__subtitle-{{ ai_gen_id }}">{{ block.settings.subtitle }}</div>
        {% endif %}
      </div>
      {% form 'contact' %}
        <div class="ai-contact-form__form-{{ ai_gen_id }}">
          <div class="ai-contact-form__field-group-{{ ai_gen_id }} ai-contact-form__field-group-{{ ai_gen_id }}--two-columns">
            <div class="ai-contact-form__field-{{ ai_gen_id }}">
              <label for="ai-contact-name-{{ ai_gen_id }}" class="ai-contact-form__label-{{ ai_gen_id }}">Navn *</label>
              <input type="text" id="ai-contact-name-{{ ai_gen_id }}" name="contact[name]" class="ai-contact-form__input-{{ ai_gen_id }}" value="{{ form.name }}" placeholder="Ditt fulle navn" required aria-required="true">
            </div>
            <div class="ai-contact-form__field-{{ ai_gen_id }}">
              <label for="ai-contact-email-{{ ai_gen_id }}" class="ai-contact-form__label-{{ ai_gen_id }}">E-post *</nlabel>
              <input type="email" id="ai-contact-email-{{ ai_gen_id }}" name="contact[email]" class="ai-contact-form__input-{{ ai_gen_id }}" value="{{ form.email }}" placeholder="din@epost.no" required aria-required="true" autocomplete="email">
            </div>
          </div>
          <div class="ai-contact-form__field-group-{{ ai_gen_id }} ai-contact-form__field-group-{{ ai_gen_id }}--two-columns">
            <div class="ai-contact-form__field-{{ ai_gen_id }}">
              <label for="ai-contact-order-{{ ai_gen_id }}" class="ai-contact-form__label-{{ ai_gen_id }}">Ordrenummer (valgfritt)</label>
              <input type="text" id="ai-contact-order-{{ ai_gen_id }}" name="contact[order_number]" class="ai-contact-form__input-{{ ai_gen_id }}" value="{{ form.order_number }}" placeholder="#1001">
            </div>
            <div class="ai-contact-form__field-{{ ai_gen_id }}">
              <label for="ai-contact-subject-{{ ai_gen_id }}" class="ai-contact-form__label-{{ ai_gen_id }}">Emne *</label>
              <select id="ai-contact-subject-{{ ai_gen_id }}" name="contact[subject]" class="ai-contact-form__select-{{ ai_gen_id }}" required aria-required="true">
                <option value="">Velg emne</option>
                <option value="Retur" {% if form.subject == 'Retur' %}selected{% endif %}>Retur</option>
                <option value="Feil størrelse" {% if form.subject == 'Feil størrelse' %}selected{% endif %}>Feil størrelse</option>
                <option value="Spørsmål om levering" {% if form.subject == 'Spørsmål om levering' %}selected{% endif %}>Spørsmål om levering</option>
                <option value="Annet" {% if form.subject == 'Annet' %}selected{% endif %}>Annet</option>
              </select>
            </div>
          </div>
          <div class="ai-contact-form__field-{{ ai_gen_id }}">
            <label for="ai-contact-message-{{ ai_gen_id }}" class="ai-contact-form__label-{{ ai_gen_id }}">Melding *</label>
            <textarea id="ai-contact-message-{{ ai_gen_id }}" name="contact[body]" class="ai-contact-form__textarea-{{ ai_gen_id }}" placeholder="Beskriv ditt spørsmål eller problem..." required aria-required="true">{{ form.body }}</textarea>
          </div>
          <button type="submit" class="ai-contact-form__button-{{ ai_gen_id }}">{{ block.settings.button_text }}</button>
          {% if form.posted_successfully? %}
            <div class="ai-contact-form__message-{{ ai_gen_id }} ai-contact-form__success-{{ ai_gen_id }}">{{ block.settings.success_message }}</div>
          {% endif %}
          {% if form.errors %}
            <div class="ai-contact-form__message-{{ ai_gen_id }} ai-contact-form__error-{{ ai_gen_id }}">
              {% for field in form.errors %}
                <p>{{ field | capitalize }} {{ form.errors.messages[field] }}</p>
              {% endfor %}
            </div>
          {% endif %}
        </div>
      {% endform %}
    </div>
  </div>
</div>
