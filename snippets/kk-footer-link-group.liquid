{% comment %}
  Link group block snippet for KK Footer
  
  Accepts:
  - block: link_group block object with settings
{% endcomment %}

{%- assign heading_size = block.settings.heading_size | default: 20 | plus: 0 -%}
{%- assign link_size = block.settings.link_size | default: 15 | plus: 0 -%}
{%- assign link_group_heading = block.settings.heading | default: 'Lenker' -%}
{%- assign link_gap = block.settings.link_spacing | default: 12 | plus: 0 -%}
{%- assign link_group_id = 'footer-links-' | append: block.id -%}

<div class="kk-footer__link-group" data-footer-accordion>
  <button
    class="kk-footer__link-group-toggle"
    type="button"
    data-footer-accordion-toggle
    aria-expanded="true"
    aria-controls="{{ link_group_id }}"
    role="heading"
    aria-level="2"
    style="--kk-footer-heading-size: {{ heading_size }}px;"
  >
    <span class="kk-footer__link-group-title">{{ link_group_heading }}</span>
    <span class="kk-footer__link-group-icon" aria-hidden="true">
      {{- 'icon-caret.svg' | inline_asset_content -}}
    </span>
  </button>
  <div
    class="kk-footer__link-group-panel"
    id="{{ link_group_id }}"
    data-footer-accordion-panel
  >
    <ul class="kk-footer__list" style="--kk-footer-link-size: {{ link_size }}px; --kk-footer-link-gap: {{ link_gap }}px;">
      {%- assign menu_handle = block.settings.menu -%}
      {%- if menu_handle != blank and linklists[menu_handle] and linklists[menu_handle].links.size > 0 -%}
        {%- for link in linklists[menu_handle].links -%}
          <li><a class="kk-footer__link" href="{{ link.url }}">{{ link.title }}</a></li>
        {%- endfor -%}
      {%- elsif block.settings.show_all_collections -%}
        {%- assign rendered_collections = 0 -%}
        {%- for collection in collections -%}
          {%- if collection == blank or collection.all_products_count == 0 -%}
            {%- continue -%}
          {%- endif -%}
          <li><a class="kk-footer__link" href="{{ collection.url }}">{{ collection.title }}</a></li>
          {%- assign rendered_collections = rendered_collections | plus: 1 -%}
          {%- if rendered_collections >= block.settings.collection_limit -%}
            {%- break -%}
          {%- endif -%}
        {%- endfor -%}
      {%- else -%}
        <li><span class="kk-footer__text" style="--kk-footer-text-size: {{ link_size }}px;">Velg en meny for Ã¥ vise lenker i denne kolonnen.</span></li>
      {%- endif -%}
      {%- if block.settings.view_all_label != blank and block.settings.view_all_url != blank -%}
        <li><a class="kk-footer__link" href="{{ block.settings.view_all_url }}">{{ block.settings.view_all_label }}</a></li>
      {%- endif -%}
    </ul>
  </div>
</div>
